<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head><title>Invoice Detail</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <h1>Invoice Detail</h1>
        <div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>
        <div th:if="${message}" class="alert alert-success" th:text="${message}"></div>
        <p><strong>Invoice ID:</strong> <span th:text="${invoice.invoiceId}"></span></p>
        <p><strong>Customer:</strong> <span th:text="${invoice.customer.name}"></span></p>
        <p><strong>Car:</strong> <span th:text="${invoice.car.model}"></span></p>
        <p><strong>Date:</strong> <span th:text="${#dates.format(invoice.date, 'dd/MM/yyyy')}"></span></p>
        <p><strong>Total Amount:</strong> <span th:text="${#numbers.formatDecimal(invoice.totalAmount, 0, 'COMMA', 2, 'POINT')} + ' VND'"></span></p>
        <p><strong>Status:</strong> <span th:text="${invoice.paymentStatus}"></span></p>
        <h4>Payment History</h4>
        <ul>
            <li th:each="p : ${invoice.paymentHistory}" th:text="'Date: ' + ${#dates.format(p.date, 'dd/MM/yyyy')} + ', Amount: ' + ${#numbers.formatDecimal(p.amount, 0, 'COMMA', 2, 'POINT')} + ' VND'"></li>
        </ul>
        <form th:action="@{/invoices/updatePayment}" method="post">
            <input type="hidden" name="invoiceId" th:value="${invoice.invoiceId}">
            <div class="mb-3"><label>Payment Amount</label><input type="number" name="amount" class="form-control" step="0.01" required></div>
            <div class="mb-3"><label>Payment Date</label><input type="date" name="paymentDate" class="form-control" required></div>
            <button type="submit" class="btn btn-primary">Add Payment</button>
        </form>
        <a th:href="@{/invoices}" class="btn btn-secondary mt-3">Back</a>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</html>